!function(a){"use strict";a.fn.rowGrouping=function(b){function c(){}function d(a,b,c){}function e(a,b,c){}function f(a){var b=["January","February","March","April","May","June","July","August","September","October","November","December"];return b[a-1]}var g={iGroupingColumnIndex:0,sGroupingColumnSortDirection:"",iGroupingOrderByColumnIndex:-1,sGroupingClass:"group",sGroupItemClass:"group-item",bHideGroupingColumn:!0,bHideGroupingOrderByColumn:!0,sGroupBy:"name",sGroupLabelPrefix:"",fnGroupLabelFormat:function(a){return a},bExpandableGrouping:!1,bExpandSingleGroup:!1,iExpandGroupOffset:100,asExpandedGroups:null,sDateFormat:"dd/MM/yyyy",sEmptyGroupLabel:"-",bSetGroupingClassOnTR:!1,iGroupingColumnIndex2:-1,sGroupingColumnSortDirection2:"",iGroupingOrderByColumnIndex2:-1,sGroupingClass2:"subgroup",sGroupItemClass2:"subgroup-item",bHideGroupingColumn2:!0,bHideGroupingOrderByColumn2:!0,sGroupBy2:"name",sGroupLabelPrefix2:"",fnGroupLabelFormat2:function(a){return a},bExpandableGrouping2:!1,fnOnGrouped:c,fnOnGroupCreated:d,fnOnGroupCompleted:e,oHideEffect:null,oShowEffect:null,bUseFilteringForGrouping:!1};return this.each(function(c,d){function i(b,c,d){var f=document.createElement("tr"),g=document.createElement("td");f.id="group-id-"+e.attr("id")+"_"+b;var i={id:f.id,key:b,text:c,level:0,groupItemClass:".group-item-"+b,dataGroup:b,aoSubgroups:new Array};return A.bSetGroupingClassOnTR?f.className=A.sGroupingClass+" "+b:g.className=A.sGroupingClass+" "+b,g.colSpan=d,g.innerHTML=A.sGroupLabelPrefix+A.fnGroupLabelFormat(""==c?A.sEmptyGroupLabel:c,i),A.bExpandableGrouping&&(k(b)?(g.className+=" collapsed-group",i.state="collapsed"):(g.className+=" expanded-group",i.state="expanded"),g.className+=" group-item-expander",a(g).attr("data-group",i.dataGroup),a(g).attr("data-group-level",i.level),a(g).click(u)),f.appendChild(g),h[b]=i,i.nGroup=f,A.fnOnGroupCreated(i,b,1),i}function j(b,c,d,e){var f=document.createElement("tr");f.id=e.id+"_"+b;var g=document.createElement("td"),i=e.dataGroup+"_"+b,j={id:f.id,key:b,text:c,level:e.level+1,groupItemClass:".group-item-"+i,dataGroup:i,aoSubgroups:new Array};return A.bSetGroupingClassOnTR?f.className=A.sGroupingClass2+" "+b:g.className=A.sGroupingClass2+" "+b,g.colSpan=d,g.innerHTML=A.sGroupLabelPrefix2+A.fnGroupLabelFormat2(""==c?A.sEmptyGroupLabel:c,j),A.bExpandableGrouping&&(f.className+=" group-item-"+e.dataGroup),A.bExpandableGrouping&&A.bExpandableGrouping2&&(k(j.dataGroup)?(g.className+=" collapsed-group",j.state="collapsed"):(g.className+=" expanded-group",j.state="expanded"),g.className+=" group-item-expander",a(g).attr("data-group",j.dataGroup),a(g).attr("data-group-level",j.level),a(g).click(u)),f.appendChild(g),e.aoSubgroups[j.dataGroup]=j,h[j.dataGroup]=j,j.nGroup=f,A.fnOnGroupCreated(j,b,2),j}function k(b){return null!=h[b]?"collapsed"==h[b].state:b.indexOf("_")>-1?void 0:(!z||null!=y&&0!=y.length)&&a.inArray(b,y)==-1}function l(a){return a.length<w+x?a:a.substr(w,x)}function m(a){return a}function n(a){return a.substr(0,1)}function o(a){return l(a)}function p(a){return a.substr(w,x)+" "+f(a.substr(B,C))}function q(a){return"undefined"==typeof a||""===a?A.sEmptyGroupLabel:a.toLowerCase().replace(/[^a-zA-Z0-9\u0080-\uFFFF]+/g,"-")}function r(a,b,c){if(a.nTable.id!==e[0].id)return!0;var d=b[A.iGroupingColumnIndex];return"undefined"==typeof d&&(d=b[a.aoColumns[A.iGroupingColumnIndex].mData]),!k(q(d))||(e.fnIsOpen(e.fnGetNodes(c))&&(null!=A.fnOnRowClosed&&A.fnOnRowClosed(this),e.fnClose(e.fnGetNodes(c))),!1)}function s(b){return h[b].state="expanded",a("td[data-group='"+b+"']").removeClass("collapsed-group"),a("td[data-group='"+b+"']").addClass("expanded-group"),A.bUseFilteringForGrouping?void e.fnDraw():(jQuery.inArray(b,y)==-1&&y.push(b),void(null!=A.oHideEffect?a(".group-item-"+b,e)[A.oShowEffect.method](A.oShowEffect.duration,A.oShowEffect.easing,function(){}):a(".group-item-"+b,e).show()))}function t(b){return h[b].state="collapsed",a("td[data-group='"+b+"']").removeClass("expanded-group"),a("td[data-group='"+b+"']").addClass("collapsed-group"),A.bUseFilteringForGrouping?void e.fnDraw():(a(".group-item-"+b).each(function(){e.fnIsOpen(this)&&(null!=A.fnOnRowClosed&&A.fnOnRowClosed(this),e.fnClose(this))}),void(null!=A.oHideEffect?a(".group-item-"+b,e)[A.oHideEffect.method](A.oHideEffect.duration,A.oHideEffect.easing,function(){}):a(".group-item-"+b,e).hide()))}function u(b){var c=a(this).attr("data-group"),f=(a(this).attr("data-group-level"),!k(c));if(A.bExpandSingleGroup){if(!f){var g=a("td.expanded-group").attr("data-group");if(t(g),s(c),A.iExpandGroupOffset!=-1){var h=a("#group-id-"+e.attr("id")+"_"+c).offset().top-A.iExpandGroupOffset;window.scroll(0,h)}else{var h=e.offset().top;window.scroll(0,h)}}}else f?t(c):s(c);b.preventDefault()}function v(b){e.fnSettings().oFeatures.bServerSide&&(z=!0);var c=!1;if(A.iGroupingColumnIndex2!=-1&&(c=!0),0!=b.aiDisplayMaster.length){for(var d=a("tbody tr",e),f=0,g=0;g<b.aoColumns.length;g++)b.aoColumns[g].bVisible&&(f+=1);var l=null,m=null;if(b.aiDisplay.length>0)for(var n=0;n<d.length;n++){var o=b._iDisplayStart+n;e.fnSettings().oFeatures.bServerSide&&(o=n);var p="",r=null,s="",t=null;p=this.fnGetData(d[n],A.iGroupingColumnIndex);var r=p;if("year"!=A.sGroupBy&&(r=D(p)),c&&(s=b.aoData[b.aiDisplay[o]]._aData[A.iGroupingColumnIndex2],void 0==s&&(s=b.aoData[b.aiDisplay[o]]._aData[b.aoColumns[A.iGroupingColumnIndex2].mData]),"year"!=A.sGroupBy2&&(t=D(s))),null==l||q(r)!=q(l)){var u=q(r);null!=l&&A.fnOnGroupCompleted(h[q(l)]),A.bAddAllGroupsAsExpanded&&jQuery.inArray(u,y)==-1&&y.push(u);var v=i(u,r,f),w=v.nGroup;null!=d[n].parentNode?d[n].parentNode.insertBefore(w,d[n]):a(d[n]).before(w),l=r,m=null}if(a(d[n]).attr("data-group",h[u].dataGroup),a(d[n]).addClass(A.sGroupItemClass),a(d[n]).addClass("group-item-"+u),A.bExpandableGrouping&&k(u)&&!A.bUseFilteringForGrouping&&a(d[n]).hide(),c){if(null==m||q(t)!=q(m)){var x=q(r)+"-"+q(t),B=j(x,t,f,h[u]),C=B.nGroup;d[n].parentNode.insertBefore(C,d[n]),m=t}a(d[n]).attr("data-group",B.dataGroup).addClass(A.sGroupItemClass2).addClass("group-item-"+B.dataGroup)}}null!=l&&A.fnOnGroupCompleted(h[q(l)]),A.fnOnGrouped(h),z=!1}}var e=a(d).dataTable(),h=new Array;a(this).dataTableExt.aoGroups=h;var w=6,x=4,y=new Array,z=!0,A=a.extend(g,b);A.iGroupingOrderByColumnIndex==-1?(A.bCustomColumnOrdering=!1,A.iGroupingOrderByColumnIndex=A.iGroupingColumnIndex):A.bCustomColumnOrdering=!0,""==A.sGroupingColumnSortDirection&&("year"==A.sGroupBy?A.sGroupingColumnSortDirection="desc":A.sGroupingColumnSortDirection="asc"),A.iGroupingOrderByColumnIndex2==-1?(A.bCustomColumnOrdering2=!1,A.iGroupingOrderByColumnIndex2=A.iGroupingColumnIndex2):A.bCustomColumnOrdering2=!0,""==A.sGroupingColumnSortDirection2&&("year"==A.sGroupBy2?A.sGroupingColumnSortDirection2="desc":A.sGroupingColumnSortDirection2="asc"),w=A.sDateFormat.toLowerCase().indexOf("yy"),x=A.sDateFormat.toLowerCase().lastIndexOf("y")-A.sDateFormat.toLowerCase().indexOf("y")+1;var B=A.sDateFormat.toLowerCase().indexOf("mm"),C=A.sDateFormat.toLowerCase().lastIndexOf("m")-A.sDateFormat.toLowerCase().indexOf("m")+1,D=m;switch(A.sGroupBy){case"letter":D=n;break;case"year":D=o;break;case"month":D=p;break;default:D=m}if(null!=A.asExpandedGroups){if("NONE"==A.asExpandedGroups)A.asExpandedGroups=[],y=A.asExpandedGroups,z=!1;else if("ALL"==A.asExpandedGroups)A.bAddAllGroupsAsExpanded=!0;else if(A.asExpandedGroups.constructor==String){var E=A.asExpandedGroups;A.asExpandedGroups=new Array,A.asExpandedGroups.push(q(E)),y=A.asExpandedGroups,z=!1}else if(A.asExpandedGroups.constructor==Array){for(var F=0;F<A.asExpandedGroups.length&&(y.push(q(A.asExpandedGroups[F])),!A.bExpandSingleGroup);F++);z=!1}}else A.asExpandedGroups=new Array,A.bAddAllGroupsAsExpanded=!0;if(A.bExpandSingleGroup){var G=a("tbody tr",e),H=e.fnGetData(G[0],A.iGroupingColumnIndex),I=H;"year"!=A.sGroupBy&&(I=D(H));var J=q(I);A.asExpandedGroups=new Array,A.asExpandedGroups.push(J)}e.fnSetColumnVis(A.iGroupingColumnIndex,!A.bHideGroupingColumn),A.bCustomColumnOrdering&&e.fnSetColumnVis(A.iGroupingOrderByColumnIndex,!A.bHideGroupingOrderByColumn),A.iGroupingColumnIndex2!=-1&&e.fnSetColumnVis(A.iGroupingColumnIndex2,!A.bHideGroupingColumn2),A.bCustomColumnOrdering2&&e.fnSetColumnVis(A.iGroupingOrderByColumnIndex2,!A.bHideGroupingOrderByColumn2),e.fnSettings().aoDrawCallback.push({fn:v,sName:"fnRowGrouping"});var K=new Array;switch(K.push([A.iGroupingOrderByColumnIndex,A.sGroupingColumnSortDirection]),A.iGroupingColumnIndex2!=-1&&K.push([A.iGroupingOrderByColumnIndex2,A.sGroupingColumnSortDirection2]),e.fnSettings().aaSortingFixed=K,A.sGroupBy){case"name":break;case"letter":e.fnSettings().aoColumns[A.iGroupingOrderByColumnIndex].sSortDataType="rg-letter",a.fn.dataTableExt.afnSortData["rg-letter"]=function(b,c){var d=[];return a("td:eq("+c+")",b.oApi._fnGetTrNodes(b)).each(function(){d.push(n(this.innerHTML))}),d};break;case"year":e.fnSettings().aoColumns[A.iGroupingOrderByColumnIndex].sSortDataType="rg-date",a.fn.dataTableExt.afnSortData["rg-date"]=function(a,b){var c=[],d=a.oApi._fnGetTrNodes(a);for(F=0;F<d.length;F++)c.push(l(e.fnGetData(d[F],b)));return c}}A.bUseFilteringForGrouping&&a.fn.dataTableExt.afnFiltering.push(r),e.fnDraw()})}}(jQuery);