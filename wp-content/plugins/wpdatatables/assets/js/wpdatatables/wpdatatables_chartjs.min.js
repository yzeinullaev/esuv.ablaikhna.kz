var wpDataTablesChartJS=function(){var a={container:"#chartJSContainer",canvas:"#chartJSCanvas",columnIndexes:[],connectedWPDataTable:null,renderCallback:null,chart:null,pieCharts:["chartjs_polar_area_chart","chartjs_pie_chart","chartjs_doughnut_chart"],setContainer:function(a){this.container=a},setCanvas:function(a){this.canvas=a},setContainerOptions:function(a){0==a.container.width?this.container.style.width=null:this.container.style.width=a.container.width+"px",this.container.style.height=a.container.height+"px",this.canvas.style.backgroundColor=a.canvas.backgroundColor,this.canvas.style.border=a.canvas.borderWidth+"px solid "+a.canvas.borderColor,this.canvas.style.borderRadius=a.canvas.borderRadius+"px"},setRenderCallback:function(a){this.renderCallback=a},globalOptions:{},options:{data:{},options:{scales:{xAxes:[{scaleLabel:{display:!0}}],yAxes:[{scaleLabel:{display:!0},ticks:{beginAtZero:!0}}]},title:{text:"",display:!0,position:"top",fontSize:16,fontColor:"#666"},legend:{display:!0,labels:{fontColor:"#666",fontSize:12,boxWidth:40}},tooltips:{enabled:!0,mode:"single",backgroundColor:"rgba(0,0,0,0.8)",titleFontSize:12,titleFontStyle:"bold",titleFontColor:"#fff",bodyFontSize:12,bodyFontStyle:"normal",caretSize:5,cornerRadius:6},maintainAspectRatio:!1}},setOptions:function(a){for(var b in a)for(var c in a[b])c&&(this.options.options[b][c]=a[b][c])},setGlobalOptions:function(a){for(var b in a)a[b]&&(this.globalOptions[b]=a[b])},setData:function(a){for(var b in a)this.options.data[b]=a[b]},getOptions:function(){return this.options},render:function(){null!==this.renderCallback&&this.renderCallback(this);for(var a in this.globalOptions)Chart.defaults.global[a]=this.globalOptions[a];this.chart=new Chart(this.canvas,this.options)},setType:function(a){switch(a){case"chartjs_line_chart":Chart.defaults.global.elements.line.fill=!1,this.options.type="line";break;case"chartjs_area_chart":Chart.defaults.global.elements.line.fill=!0,this.options.type="line";break;case"chartjs_stacked_area_chart":Chart.defaults.global.elements.line.fill=!0,this.options.type="line",this.options.options.scales.yAxes[0].stacked=!0;break;case"chartjs_column_chart":Chart.defaults.global.elements.line.fill=!0,this.options.type="bar";break;case"chartjs_radar_chart":Chart.defaults.global.elements.line.fill=!0,this.options.type="radar";break;case"chartjs_polar_area_chart":this.options.type="polarArea";break;case"chartjs_pie_chart":this.options.type="pie";break;case"chartjs_doughnut_chart":this.options.type="doughnut";break;case"chartjs_bubble_chart":this.options.type="bubble"}},setColumnIndexes:function(a){this.columnIndexes=a},setConnectedWPDataTable:function(a){this.connectedWPDataTable=a},setGrouping:function(a){this.group_chart=a},setChartConfig:function(a){if(1==a.responsive_width?this.container.style.width=null:(this.container.style.width=a.width+"px",this.options.options.maintainAspectRatio=!1),a.height?this.container.style.height=a.height+"px":null,this.canvas.style.backgroundColor=a.background_color,this.canvas.style.border=a.border_width+"px solid "+a.border_color,a.border_radius?this.canvas.style.borderRadius=a.border_radius+"px":null,a.font_size?this.globalOptions.defaultFontSize=a.font_size:null,a.font_name?this.globalOptions.defaultFontFamily=a.font_name:null,a.font_style?this.globalOptions.defaultFontStyle=a.font_style:null,this.globalOptions.defaultFontColor=a.font_color,this.pieCharts.indexOf(a.chart_type)==-1&&"chartjs_bubble_chart"!=a.chart_type){var b=0;for(var c in a.series_data)this.options.data.datasets[b].label=a.series_data[c].label,a.series_data[c].color?this.options.data.datasets[b].borderColor=a.series_data[c].color:null,a.series_data[c].color?this.options.data.datasets[b].backgroundColor="rgba("+hexToRgb(a.series_data[c].color).r+", "+hexToRgb(a.series_data[c].color).g+", "+hexToRgb(a.series_data[c].color).b+", 0.2)":null,b++;if(1==a.curve_type)for(c in this.options.data.datasets)this.options.data.datasets[c].lineTension=.4;else for(c in this.options.data.datasets)this.options.data.datasets[c].lineTension=0}0==a.show_grid?(this.options.options.scales.xAxes[0].display=!1,this.options.options.scales.yAxes[0].display=!1):(this.options.options.scales.xAxes[0].display=!0,this.options.options.scales.yAxes[0].display=!0),a.horizontal_axis_label?this.options.options.scales.xAxes[0].scaleLabel.labelString=a.horizontal_axis_label:null,a.vertical_axis_label?this.options.options.scales.yAxes[0].scaleLabel.labelString=a.vertical_axis_label:null,a.vertical_axis_min?this.options.options.scales.yAxes[0].ticks.min=parseInt(a.vertical_axis_min):this.options.options.scales.yAxes[0].ticks.beginAtZero=!0,a.vertical_axis_max?this.options.options.scales.yAxes[0].ticks.max=parseInt(a.vertical_axis_max):null,1==a.show_title?(this.options.options.title.display=!0,this.options.options.title.text=a.chart_title):this.options.options.title.display=!1,a.title_position?this.options.options.title.position=a.title_position:null,a.title_font_name?this.options.options.title.fontFamily=a.title_font_name:null,a.title_font_style?this.options.options.title.fontStyle=a.title_font_style:null,a.title_font_color?this.options.options.title.fontColor=a.title_font_color:this.options.options.title.fontColor="#666",1==a.tooltip_enabled?this.options.options.tooltips.enabled=!0:this.options.options.tooltips.enabled=!1,a.tooltip_background_color?this.options.options.tooltips.backgroundColor=a.tooltip_background_color:this.options.options.tooltips.backgroundColor="rgba(0,0,0,0.8)",a.tooltip_border_radius?this.options.options.tooltips.cornerRadius=parseInt(a.tooltip_border_radius):null,1==a.tooltip_shared?this.options.options.tooltips.mode="label":this.options.options.tooltips.mode="single",1==a.show_legend?this.options.options.legend.display=!0:this.options.options.legend.display=!1,a.legend_position_cjs?this.options.options.legend.position=a.legend_position_cjs:null},enableFollowFiltering:function(){null!=this.connectedWPDataTable&&(this.numberFormat=jQuery.parseJSON(jQuery("#"+this.connectedWPDataTable.data("described-by")).val()).number_format,this.connectedWPDataTable.fnSettings().aoDrawCallback.push({sName:"chart_filter_follow",fn:function(b){a.options.data.labels=[];var c=[],d=0,e=a.connectedWPDataTable._("tr",{filter:"applied"}).toArray();for(var f in a.columnIndexes){var g=[];if(a.columnIndexes.length>0&&0==f){for(var h in e)a.options.data.labels.push(e[h][a.columnIndexes[f]]);c=a.options.data.labels}else{for(var h in e){var i=e[h][a.columnIndexes[f]];1==a.numberFormat?g.push(parseFloat(wdtUnformatNumber(i,".",",",!0))):g.push(parseFloat(wdtUnformatNumber(i,",",".",!0)))}if(1==a.group_chart){var j=[],k=[];for(var h in c)if("undefined"!=typeof j&&j.length>0){var l="none";for(var f in j)"none"===l&&j[f]==c[h]&&(l=f);"none"===l?(j.push(c[h]),k.push(g[h])):k[l]+=g[h]}else j.push(c[h]),k.push(g[h]);a.options.data.labels=j,g=k}a.options.data.datasets[d].data=g,d++}}null!==a.chart&&a.chart.destroy(),null!==a.renderCallback&&a.renderCallback(a),a.chart=new Chart(a.canvas,a.options)}}))}};return a};